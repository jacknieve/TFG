<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org"
	xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
    <head>
        <title>Hola usuario!</title>
        <meta charset="UTF-8">
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.1/angular.min.js"></script>
		<script type="text/javascript" th:src="@{/js/userconsumer.js}"></script>
    </head>
    <body ng-app="appConsumer">
    <div ng-controller="userController">
        <h1>Eres un mentor!</h1>
        <h1 th:text="Formulario">form</h1>
		<form name="form">
    		<div>
        		Correo: <span th:text="${correo}"/>
    		</div>
    		<div>
        		Rol: <span th:text="${rol}"/>
    		</div>
    		<div th:if="${fregistro}">
        		Fecha de registro: <span th:text="${fregistro}"/>
    		</div>
    		<div th:if="${error}">
        		Se ha producido un error: <span th:text="${error}"/>
    		</div>
    		<div>
        		<label>Nombre</label>
        		<input ng-model="usuario.nombre" name="nombre" ng-pattern="/^[a-zA-ZÀ-ÿ\u00f1\u00d1]{1,255}$/" required/>
        		<span ng-show="form.nombre.$error.required">Es necesario introducir un nombre. </span>
        		<span ng-show="form.nombre.$error.pattern">No tiene el formato correcto </span>
    		</div>
    		<div>
        		<label>Primer apellido</label>
        		<input ng-model="usuario.papellido" name="papellido" ng-pattern="/^[a-zA-ZÀ-ÿ\u00f1\u00d1]{0,255}$/"/>
        		<span ng-show="form.papellido.$error.pattern">No tiene el formato correcto </span>
    		</div>
    		<div>
        		<label>Segundo apellido</label>
        		<input ng-model="usuario.sapellido" name="sapellido" ng-pattern="/^[a-zA-ZÀ-ÿ\u00f1\u00d1]{0,255}$/"/>
        		<span ng-show="form.sapellido.$error.pattern">No tiene el formato correcto </span>
    		</div>
    		<div>
        		<label>Telefono</label>
        		<input type="tel" ng-model="usuario.telefono" name="telefono" ng-pattern="/^([+][0-9]{2})?[0-9]{9}$/"/>
        		<span ng-show="form.sapellido.$error.pattern">No tiene el formato correcto </span>
    		</div>
    		<div>
        		<label >Nivel de estudios:</label>
        		<select ng-model="usuario.nivelEstudiosNivelestudios">
        		<div>
        			<!--<option th:value="Otros" th:text="'--Escoge uno--'"></option>-->
        			<option th:each="i : ${estudios}" th:value="${i.nivelestudios}" th:text="${i.nivelestudios}">
        			</option>
        		</div>
        		</select>
    		</div>
    		<div>
        		<label>Descripción</label>
        		<textarea ng-model="usuario.descripcion" maxlength="500" name="descripcion"></textarea>
        		Caracteres restantes : {{500 - usuario.descripcion.length}}
    		</div>
    		<div>
        		<label>Tu linkedin</label>
        		<input type="url" ng-model="usuario.linkedin" name="linkedin"/>
        		<span ng-hide="form.linkedin.$valid">No tiene el formato correcto </span>
    		</div>
    		<div ng-show="usuario.mentor">
        		<label >Horas por mes</label>
        		<input type="number" ng-model="usuario.horaspormes" name="horaspormes" min="4" max="80" required/>
        		<span ng-show="form.horaspormes.$invalid">El numero de horas debe estar entre 4 y 80. </span>
    		</div>
    		<div>
    			Fecha de nacimiento:
        		<input type="date" ng-model="mydate"/>
    		</div >
    		<div>
        		<label>Institución:</label>
        		<select ng-model="usuario.institucionNombre">
        			<option th:each="i : ${instituciones}" th:value="${i}" th:text="${i}">
        			</option>
        		</select>
    		</div>
    		<div ng-show="usuario.mentor">
        		<label>Puesto</label>
        		<select ng-model="usuario.puestoPuesto">
        			<!--<option th:value="Otro" th:text="'--Escoge uno--'"></option>-->
        			<option th:each="i : ${puestos}" th:value="${i.puesto}" th:text="${i.puesto}">
        			</option>
        		</select>
    		</div>
    		
		</form>
		<p>Areas de conocimiento</p>
		<div ng-show="cargando">Cargando...</div>
		<ul>
			<li ng-repeat="area in usuario.areas">{{area.area}} <button ng-click="borrarArea(area)">Borrar</button>
			</li>
		</ul>
		<div ng-show="sinareas">No tienes ninguna área de conocimiento escogida</div>
		
		<div>
        	<label th:text="'Añadir nueva area'">Añadir nueva area</label>
        		<select ng-model="areaseleccioanda">
        		<option th:value="'--Escoge una--'" th:text="'--Escoge una--'"></option>
        			<option th:each="i : ${areas}" th:value="${i.area}" th:text="${i.area}">
        			</option>
        		</select>
        		<button ng-click="addArea(areaseleccioanda)">Añadir</button>
    		</div>
		<div><button th:text="Aceptar"  ng-click="setInfo(usuario)">submit</button>
		<button th:text="Deshacer"  ng-click="deshacer()">submit</button> (No se recuperaran las areas borradas)</div>
        <a th:href="@{/auth/logout}" th:text="Logout">logout</a>
        <a th:href="@{/user/principal}" th:text="'Volver a la página principal'">Volver a pagina principal</a>
        <p>Sección para borrar la cuenta de usuario</p>
        <form action='#' th:action="@{/user/eliminar}" method="POST" enctype="utf8">
        	<div>
        		<label th:text="'Introduzca su contraseña para borrar su cuenta'">Introduzca su contraseña</label>
        		<input type="password" id="password" name="password" maxlength="255" required/>
    		</div>
    		<div>
    		<div ng-show="confirmarBorrar" >¿Seguro que desea realizar esta acción?, esta acción no es reversible (de momento) y su cuenta de correo no podrá ser usada en otra cuenta.
    		<button type="submit" th:text="Confirmar">confirmar</button>
    		<button th:text="Cancelar"  ng-click="confirmarBorrar = false">submit</button></div>
    		</div>
        </form>
        <button ng-hide="confirmarBorrar" th:text="Aceptar"  ng-click="confirmarBorrar = true">submit</button>
        </div>
    </body>
</html>